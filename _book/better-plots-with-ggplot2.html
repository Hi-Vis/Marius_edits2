<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 8 Better plots with ggplot2 | Matilda Intro to R Workshop</title>
  <meta name="description" content="An accessible introduction to R that doesn’t assume programming experience" />
  <meta name="generator" content="bookdown 0.28 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 8 Better plots with ggplot2 | Matilda Intro to R Workshop" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://bookdown.org/rachel_visontay/Rad/Images/Cover.png" />
  <meta property="og:description" content="An accessible introduction to R that doesn’t assume programming experience" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 8 Better plots with ggplot2 | Matilda Intro to R Workshop" />
  
  <meta name="twitter:description" content="An accessible introduction to R that doesn’t assume programming experience" />
  <meta name="twitter:image" content="https://bookdown.org/rachel_visontay/Rad/Images/Cover.png" />

<meta name="author" content="Marius Mather (with tweaks by Rachel Visontay)" />


<meta name="date" content="2022-08-26" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="Images/rad_logo_r.png" type="image/x-icon" />
<link rel="prev" href="tidyverse.html"/>
<link rel="next" href="real-world-data-example.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a></li>
<li class="chapter" data-level="1" data-path="installing.html"><a href="installing.html"><i class="fa fa-check"></i><b>1</b> Getting started with R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="installing.html"><a href="installing.html#installing-r"><i class="fa fa-check"></i><b>1.1</b> Installing R</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="installing.html"><a href="installing.html#windows-instructions"><i class="fa fa-check"></i><b>1.1.1</b> Windows instructions</a></li>
<li class="chapter" data-level="1.1.2" data-path="installing.html"><a href="installing.html#mac-os-x-instructions"><i class="fa fa-check"></i><b>1.1.2</b> Mac OS X instructions</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="installing.html"><a href="installing.html#installing-rstudio"><i class="fa fa-check"></i><b>1.2</b> Installing RStudio</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="installing.html"><a href="installing.html#mac-os-x-notes"><i class="fa fa-check"></i><b>1.2.1</b> Mac OS X notes</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="installing.html"><a href="installing.html#running-rstudio"><i class="fa fa-check"></i><b>1.3</b> Running RStudio</a></li>
<li class="chapter" data-level="1.4" data-path="installing.html"><a href="installing.html#installing-your-first-packages"><i class="fa fa-check"></i><b>1.4</b> Installing your first packages</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="tips-for-effective-r-programming.html"><a href="tips-for-effective-r-programming.html"><i class="fa fa-check"></i><b>2</b> Tips for effective R programming</a>
<ul>
<li class="chapter" data-level="2.1" data-path="tips-for-effective-r-programming.html"><a href="tips-for-effective-r-programming.html#use-rstudios-projects-feature"><i class="fa fa-check"></i><b>2.1</b> Use RStudio’s “projects” feature</a></li>
<li class="chapter" data-level="2.2" data-path="tips-for-effective-r-programming.html"><a href="tips-for-effective-r-programming.html#using-scripts"><i class="fa fa-check"></i><b>2.2</b> Using scripts</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="tips-for-effective-r-programming.html"><a href="tips-for-effective-r-programming.html#script-layout"><i class="fa fa-check"></i><b>2.2.1</b> Script layout</a></li>
<li class="chapter" data-level="2.2.2" data-path="tips-for-effective-r-programming.html"><a href="tips-for-effective-r-programming.html#a-tip-for-better-reproducibility"><i class="fa fa-check"></i><b>2.2.2</b> A tip for better reproducibility</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="tips-for-effective-r-programming.html"><a href="tips-for-effective-r-programming.html#long-or-wide-data"><i class="fa fa-check"></i><b>2.3</b> Long or wide data</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="tips-for-effective-r-programming.html"><a href="tips-for-effective-r-programming.html#wide-to-long"><i class="fa fa-check"></i><b>2.3.1</b> Going from wide to long</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="tips-for-effective-r-programming.html"><a href="tips-for-effective-r-programming.html#writing-readable-code"><i class="fa fa-check"></i><b>2.4</b> Writing readable code</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="tips-for-effective-r-programming.html"><a href="tips-for-effective-r-programming.html#basic-formatting-tips"><i class="fa fa-check"></i><b>2.4.1</b> Basic formatting tips</a></li>
<li class="chapter" data-level="2.4.2" data-path="tips-for-effective-r-programming.html"><a href="tips-for-effective-r-programming.html#keeping-a-consistent-style"><i class="fa fa-check"></i><b>2.4.2</b> Keeping a consistent style</a></li>
<li class="chapter" data-level="2.4.3" data-path="tips-for-effective-r-programming.html"><a href="tips-for-effective-r-programming.html#writing-comments"><i class="fa fa-check"></i><b>2.4.3</b> Writing comments</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="tips-for-effective-r-programming.html"><a href="tips-for-effective-r-programming.html#dont-panic-dealing-with-spss-withdrawal"><i class="fa fa-check"></i><b>2.5</b> Don’t panic: dealing with SPSS withdrawal</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="tips-for-effective-r-programming.html"><a href="tips-for-effective-r-programming.html#rstudio-has-a-data-viewer"><i class="fa fa-check"></i><b>2.5.1</b> RStudio has a data viewer</a></li>
<li class="chapter" data-level="2.5.2" data-path="tips-for-effective-r-programming.html"><a href="tips-for-effective-r-programming.html#r-can-read-spss-files"><i class="fa fa-check"></i><b>2.5.2</b> R can read SPSS files</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="tips-for-effective-r-programming.html"><a href="tips-for-effective-r-programming.html#here-be-dragons-the-bad-parts-of-r"><i class="fa fa-check"></i><b>2.6</b> Here be dragons: the bad parts of R</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="the-basics-of-r.html"><a href="the-basics-of-r.html"><i class="fa fa-check"></i><b>3</b> The Basics of R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="the-basics-of-r.html"><a href="the-basics-of-r.html#basic-data-types"><i class="fa fa-check"></i><b>3.1</b> Basic data types</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="the-basics-of-r.html"><a href="the-basics-of-r.html#numbers"><i class="fa fa-check"></i><b>3.1.1</b> Numbers</a></li>
<li class="chapter" data-level="3.1.2" data-path="the-basics-of-r.html"><a href="the-basics-of-r.html#characters-text"><i class="fa fa-check"></i><b>3.1.2</b> Characters (text)</a></li>
<li class="chapter" data-level="3.1.3" data-path="the-basics-of-r.html"><a href="the-basics-of-r.html#logical-truefalse"><i class="fa fa-check"></i><b>3.1.3</b> Logical (True/False)</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="the-basics-of-r.html"><a href="the-basics-of-r.html#converting-between-types"><i class="fa fa-check"></i><b>3.2</b> Converting between types</a></li>
<li class="chapter" data-level="3.3" data-path="the-basics-of-r.html"><a href="the-basics-of-r.html#variables-storing-results"><i class="fa fa-check"></i><b>3.3</b> Variables: Storing Results</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="the-basics-of-r.html"><a href="the-basics-of-r.html#copying-variables"><i class="fa fa-check"></i><b>3.3.1</b> Copying Variables</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="the-basics-of-r.html"><a href="the-basics-of-r.html#vectors"><i class="fa fa-check"></i><b>3.4</b> Vectors</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="the-basics-of-r.html"><a href="the-basics-of-r.html#calculating-with-vectors"><i class="fa fa-check"></i><b>3.4.1</b> Calculating with vectors</a></li>
<li class="chapter" data-level="3.4.2" data-path="the-basics-of-r.html"><a href="the-basics-of-r.html#missing-values"><i class="fa fa-check"></i><b>3.4.2</b> Missing values</a></li>
<li class="chapter" data-level="3.4.3" data-path="the-basics-of-r.html"><a href="the-basics-of-r.html#indexing-accessing-parts-of-vectors"><i class="fa fa-check"></i><b>3.4.3</b> Indexing: accessing parts of vectors</a></li>
<li class="chapter" data-level="3.4.4" data-path="the-basics-of-r.html"><a href="the-basics-of-r.html#logical-indexing-filtering-your-data-based-on-conditions"><i class="fa fa-check"></i><b>3.4.4</b> Logical indexing: filtering your data based on conditions</a></li>
<li class="chapter" data-level="3.4.5" data-path="the-basics-of-r.html"><a href="the-basics-of-r.html#changing-vectors"><i class="fa fa-check"></i><b>3.4.5</b> Changing vectors</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="dataframes-and-more.html"><a href="dataframes-and-more.html"><i class="fa fa-check"></i><b>4</b> Dataframes and More</a>
<ul>
<li class="chapter" data-level="4.1" data-path="dataframes-and-more.html"><a href="dataframes-and-more.html#factors-categorical-data"><i class="fa fa-check"></i><b>4.1</b> Factors (categorical data)</a></li>
<li class="chapter" data-level="4.2" data-path="dataframes-and-more.html"><a href="dataframes-and-more.html#lists"><i class="fa fa-check"></i><b>4.2</b> Lists</a></li>
<li class="chapter" data-level="4.3" data-path="dataframes-and-more.html"><a href="dataframes-and-more.html#dataframes"><i class="fa fa-check"></i><b>4.3</b> Dataframes!</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="dataframes-and-more.html"><a href="dataframes-and-more.html#accessing-parts-of-dataframes"><i class="fa fa-check"></i><b>4.3.1</b> Accessing parts of dataframes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>5</b> Functions</a>
<ul>
<li class="chapter" data-level="5.1" data-path="functions.html"><a href="functions.html#arguments"><i class="fa fa-check"></i><b>5.1</b> Arguments</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="functions.html"><a href="functions.html#positional-or-named-arguments"><i class="fa fa-check"></i><b>5.1.1</b> Positional or Named Arguments</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="functions.html"><a href="functions.html#writing-your-own-functions"><i class="fa fa-check"></i><b>5.2</b> Writing your own functions</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="an-example-analysis.html"><a href="an-example-analysis.html"><i class="fa fa-check"></i><b>6</b> An Example Analysis</a>
<ul>
<li class="chapter" data-level="6.1" data-path="an-example-analysis.html"><a href="an-example-analysis.html#loading-libraries"><i class="fa fa-check"></i><b>6.1</b> Loading libraries</a></li>
<li class="chapter" data-level="6.2" data-path="an-example-analysis.html"><a href="an-example-analysis.html#loading-data"><i class="fa fa-check"></i><b>6.2</b> Loading data</a></li>
<li class="chapter" data-level="6.3" data-path="an-example-analysis.html"><a href="an-example-analysis.html#recoding"><i class="fa fa-check"></i><b>6.3</b> Recoding</a></li>
<li class="chapter" data-level="6.4" data-path="an-example-analysis.html"><a href="an-example-analysis.html#descriptive-statistics"><i class="fa fa-check"></i><b>6.4</b> Descriptive Statistics</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="an-example-analysis.html"><a href="an-example-analysis.html#quick-data-summary"><i class="fa fa-check"></i><b>6.4.1</b> Quick data summary</a></li>
<li class="chapter" data-level="6.4.2" data-path="an-example-analysis.html"><a href="an-example-analysis.html#frequency-tables"><i class="fa fa-check"></i><b>6.4.2</b> Frequency tables</a></li>
<li class="chapter" data-level="6.4.3" data-path="an-example-analysis.html"><a href="an-example-analysis.html#histograms-distributions-of-continuous-variables"><i class="fa fa-check"></i><b>6.4.3</b> Histograms: distributions of continuous variables</a></li>
<li class="chapter" data-level="6.4.4" data-path="an-example-analysis.html"><a href="an-example-analysis.html#scatterplots-relationship-between-two-continuous-variables"><i class="fa fa-check"></i><b>6.4.4</b> Scatterplots: relationship between two continuous variables</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="an-example-analysis.html"><a href="an-example-analysis.html#analysis"><i class="fa fa-check"></i><b>6.5</b> Analysis</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="an-example-analysis.html"><a href="an-example-analysis.html#t-test"><i class="fa fa-check"></i><b>6.5.1</b> T-test</a></li>
<li class="chapter" data-level="6.5.2" data-path="an-example-analysis.html"><a href="an-example-analysis.html#formulas-a-simple-mini-language-for-expressing-models"><i class="fa fa-check"></i><b>6.5.2</b> Formulas: a simple mini-language for expressing models</a></li>
<li class="chapter" data-level="6.5.3" data-path="an-example-analysis.html"><a href="an-example-analysis.html#regression"><i class="fa fa-check"></i><b>6.5.3</b> Regression</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="an-example-analysis.html"><a href="an-example-analysis.html#pointless-flashy-nonsense"><i class="fa fa-check"></i><b>6.6</b> Pointless flashy nonsense</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="tidyverse.html"><a href="tidyverse.html"><i class="fa fa-check"></i><b>7</b> Easier analysis with the tidyverse</a>
<ul>
<li class="chapter" data-level="7.1" data-path="tidyverse.html"><a href="tidyverse.html#introduction-to-the-tidyverse"><i class="fa fa-check"></i><b>7.1</b> Introduction to the tidyverse</a></li>
<li class="chapter" data-level="7.2" data-path="tidyverse.html"><a href="tidyverse.html#dplyr-turning-complex-analyses-into-simple-steps"><i class="fa fa-check"></i><b>7.2</b> <code>dplyr</code>: Turning complex analyses into simple steps</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="tidyverse.html"><a href="tidyverse.html#bending-the-rules-non-standard-evaluation"><i class="fa fa-check"></i><b>7.2.1</b> Bending the rules: Non-standard evaluation</a></li>
<li class="chapter" data-level="7.2.2" data-path="tidyverse.html"><a href="tidyverse.html#pipes"><i class="fa fa-check"></i><b>7.2.2</b> Pipes: <code>%&gt;%</code></a></li>
<li class="chapter" data-level="7.2.3" data-path="tidyverse.html"><a href="tidyverse.html#common-tasks-with-dplyr"><i class="fa fa-check"></i><b>7.2.3</b> Common tasks with <code>dplyr</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="better-plots-with-ggplot2.html"><a href="better-plots-with-ggplot2.html"><i class="fa fa-check"></i><b>8</b> Better plots with <code>ggplot2</code></a>
<ul>
<li class="chapter" data-level="8.1" data-path="better-plots-with-ggplot2.html"><a href="better-plots-with-ggplot2.html#using-ggplot2-properly"><i class="fa fa-check"></i><b>8.1</b> Using <code>ggplot2</code> properly</a></li>
<li class="chapter" data-level="8.2" data-path="better-plots-with-ggplot2.html"><a href="better-plots-with-ggplot2.html#mapping-aesthetics"><i class="fa fa-check"></i><b>8.2</b> Mapping aesthetics</a></li>
<li class="chapter" data-level="8.3" data-path="better-plots-with-ggplot2.html"><a href="better-plots-with-ggplot2.html#geoms-representing-the-data-with-different-components"><i class="fa fa-check"></i><b>8.3</b> geoms: representing the data with different components</a></li>
<li class="chapter" data-level="8.4" data-path="better-plots-with-ggplot2.html"><a href="better-plots-with-ggplot2.html#combining-geoms"><i class="fa fa-check"></i><b>8.4</b> Combining geoms</a></li>
<li class="chapter" data-level="8.5" data-path="better-plots-with-ggplot2.html"><a href="better-plots-with-ggplot2.html#scales-and-themes-changing-the-look-of-your-plot"><i class="fa fa-check"></i><b>8.5</b> Scales and themes: changing the look of your plot</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="better-plots-with-ggplot2.html"><a href="better-plots-with-ggplot2.html#scales"><i class="fa fa-check"></i><b>8.5.1</b> Scales</a></li>
<li class="chapter" data-level="8.5.2" data-path="better-plots-with-ggplot2.html"><a href="better-plots-with-ggplot2.html#themes"><i class="fa fa-check"></i><b>8.5.2</b> Themes</a></li>
<li class="chapter" data-level="8.5.3" data-path="better-plots-with-ggplot2.html"><a href="better-plots-with-ggplot2.html#finding-extra-scales-and-themes"><i class="fa fa-check"></i><b>8.5.3</b> Finding extra scales and themes</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="better-plots-with-ggplot2.html"><a href="better-plots-with-ggplot2.html#other-packages-use-ggplot2-too"><i class="fa fa-check"></i><b>8.6</b> Other packages use <code>ggplot2</code> too</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="real-world-data-example.html"><a href="real-world-data-example.html"><i class="fa fa-check"></i><b>9</b> Real world data example</a>
<ul>
<li class="chapter" data-level="9.1" data-path="real-world-data-example.html"><a href="real-world-data-example.html#data-overview"><i class="fa fa-check"></i><b>9.1</b> Data overview</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="real-world-data-example.html"><a href="real-world-data-example.html#surps-overview"><i class="fa fa-check"></i><b>9.1.1</b> SURPS overview</a></li>
<li class="chapter" data-level="9.1.2" data-path="real-world-data-example.html"><a href="real-world-data-example.html#bsi-overview"><i class="fa fa-check"></i><b>9.1.2</b> BSI overview</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="real-world-data-example.html"><a href="real-world-data-example.html#basic-setup"><i class="fa fa-check"></i><b>9.2</b> Basic setup</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="real-world-data-example.html"><a href="real-world-data-example.html#load-libraries"><i class="fa fa-check"></i><b>9.2.1</b> Load libraries</a></li>
<li class="chapter" data-level="9.2.2" data-path="real-world-data-example.html"><a href="real-world-data-example.html#load-the-data"><i class="fa fa-check"></i><b>9.2.2</b> Load the data</a></li>
<li class="chapter" data-level="9.2.3" data-path="real-world-data-example.html"><a href="real-world-data-example.html#solve-major-issues"><i class="fa fa-check"></i><b>9.2.3</b> Solve major issues</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="real-world-data-example.html"><a href="real-world-data-example.html#recoding-and-scoring"><i class="fa fa-check"></i><b>9.3</b> Recoding and scoring</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="real-world-data-example.html"><a href="real-world-data-example.html#scoring-surps-the-easy-way"><i class="fa fa-check"></i><b>9.3.1</b> Scoring SURPS the easy way</a></li>
<li class="chapter" data-level="9.3.2" data-path="real-world-data-example.html"><a href="real-world-data-example.html#scoring-surps-the-harder-way"><i class="fa fa-check"></i><b>9.3.2</b> Scoring SURPS the harder way</a></li>
<li class="chapter" data-level="9.3.3" data-path="real-world-data-example.html"><a href="real-world-data-example.html#scoring-the-bsi-scales"><i class="fa fa-check"></i><b>9.3.3</b> Scoring the BSI scales</a></li>
<li class="chapter" data-level="9.3.4" data-path="real-world-data-example.html"><a href="real-world-data-example.html#recoding-1"><i class="fa fa-check"></i><b>9.3.4</b> Recoding</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="real-world-data-example.html"><a href="real-world-data-example.html#saving-data"><i class="fa fa-check"></i><b>9.4</b> Saving data</a></li>
<li class="chapter" data-level="9.5" data-path="real-world-data-example.html"><a href="real-world-data-example.html#descriptive-statistics-1"><i class="fa fa-check"></i><b>9.5</b> Descriptive statistics</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="real-world-data-example.html"><a href="real-world-data-example.html#correlations-between-variables"><i class="fa fa-check"></i><b>9.5.1</b> Correlations between variables</a></li>
<li class="chapter" data-level="9.5.2" data-path="real-world-data-example.html"><a href="real-world-data-example.html#contingency-tables-for-categorical-data"><i class="fa fa-check"></i><b>9.5.2</b> Contingency tables for categorical data</a></li>
<li class="chapter" data-level="9.5.3" data-path="real-world-data-example.html"><a href="real-world-data-example.html#understanding-complex-data"><i class="fa fa-check"></i><b>9.5.3</b> Understanding complex data</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="real-world-data-example.html"><a href="real-world-data-example.html#analysis-1"><i class="fa fa-check"></i><b>9.6</b> Analysis</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="real-world-data-example.html"><a href="real-world-data-example.html#simple-but-wrong-logistic-regression"><i class="fa fa-check"></i><b>9.6.1</b> Simple but wrong: Logistic regression</a></li>
<li class="chapter" data-level="9.6.2" data-path="real-world-data-example.html"><a href="real-world-data-example.html#more-complex-modelling-mixed-models-with-lme4"><i class="fa fa-check"></i><b>9.6.2</b> More complex modelling: Mixed models with <code>lme4</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="learning-moregetting-help.html"><a href="learning-moregetting-help.html"><i class="fa fa-check"></i>Learning more/Getting help</a>
<ul>
<li class="chapter" data-level="" data-path="learning-moregetting-help.html"><a href="learning-moregetting-help.html#more-coursesbooks"><i class="fa fa-check"></i>More courses/books</a></li>
<li class="chapter" data-level="" data-path="learning-moregetting-help.html"><a href="learning-moregetting-help.html#checking-out-the-r-community"><i class="fa fa-check"></i>Checking out the R community</a></li>
<li class="chapter" data-level="" data-path="learning-moregetting-help.html"><a href="learning-moregetting-help.html#getting-help"><i class="fa fa-check"></i>Getting help</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="why-r-is-good.html"><a href="why-r-is-good.html"><i class="fa fa-check"></i>Why R is Good</a>
<ul>
<li class="chapter" data-level="" data-path="why-r-is-good.html"><a href="why-r-is-good.html#r-is-a-language"><i class="fa fa-check"></i>R is a Language</a></li>
<li class="chapter" data-level="" data-path="why-r-is-good.html"><a href="why-r-is-good.html#r-is-a-programming-language"><i class="fa fa-check"></i>R is a programming language</a></li>
<li class="chapter" data-level="" data-path="why-r-is-good.html"><a href="why-r-is-good.html#r-has-an-active-community"><i class="fa fa-check"></i>R has an active community</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="referencesresources-used.html"><a href="referencesresources-used.html"><i class="fa fa-check"></i>References/Resources used</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Matilda Intro to R Workshop</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="better-plots-with-ggplot2" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">Section 8</span> Better plots with <code>ggplot2</code><a href="better-plots-with-ggplot2.html#better-plots-with-ggplot2" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>R’s plotting tools are very good, and in particular, there’s
a great library called <code>ggplot2</code> that allows you to put together
a huge variety out of plots using a simple system and some
common pieces.</p>
<p><code>ggplot2</code> is loaded whenever you use <code>library(tidyverse)</code>,
but you can also load it individually:</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="better-plots-with-ggplot2.html#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb245-2"><a href="better-plots-with-ggplot2.html#cb245-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-3"><a href="better-plots-with-ggplot2.html#cb245-3" aria-hidden="true" tabindex="-1"></a>cow <span class="ot">=</span> carData<span class="sc">::</span>Cowles</span>
<span id="cb245-4"><a href="better-plots-with-ggplot2.html#cb245-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Recreating the depression variable from before</span></span>
<span id="cb245-5"><a href="better-plots-with-ggplot2.html#cb245-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb245-6"><a href="better-plots-with-ggplot2.html#cb245-6" aria-hidden="true" tabindex="-1"></a>cow<span class="sc">$</span>depression <span class="ot">=</span> <span class="fu">round</span>(</span>
<span id="cb245-7"><a href="better-plots-with-ggplot2.html#cb245-7" aria-hidden="true" tabindex="-1"></a>  <span class="dv">19</span> <span class="sc">+</span> </span>
<span id="cb245-8"><a href="better-plots-with-ggplot2.html#cb245-8" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.5</span> <span class="sc">*</span> cow<span class="sc">$</span>neuroticism <span class="sc">+</span></span>
<span id="cb245-9"><a href="better-plots-with-ggplot2.html#cb245-9" aria-hidden="true" tabindex="-1"></a>  <span class="sc">-</span><span class="fl">0.8</span> <span class="sc">*</span> cow<span class="sc">$</span>extraversion <span class="sc">+</span></span>
<span id="cb245-10"><a href="better-plots-with-ggplot2.html#cb245-10" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.5</span> <span class="sc">*</span> (cow<span class="sc">$</span>sex <span class="sc">==</span> <span class="st">&quot;female&quot;</span>) <span class="sc">+</span></span>
<span id="cb245-11"><a href="better-plots-with-ggplot2.html#cb245-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rnorm</span>(<span class="fu">nrow</span>(cow), <span class="at">sd =</span> <span class="dv">3</span>)</span>
<span id="cb245-12"><a href="better-plots-with-ggplot2.html#cb245-12" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div id="using-ggplot2-properly" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> Using <code>ggplot2</code> properly<a href="better-plots-with-ggplot2.html#using-ggplot2-properly" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><code>ggplot2</code> will always work best if:</p>
<ul>
<li>Everything you want to show in the plot is
in a single dataframe.</li>
<li>Each aspect of the plot is represented by a single
column.</li>
<li>Each column has the right data type, depending
on whether it’s categorical or continuous
(<code>factor</code> or <code>numeric</code>).</li>
<li>All the data is labelled: categorical variables
should already have the labels that you want to show in the plot.</li>
</ul>
<p>You can make plots work if you don’t have have those
things, but they will be much clunkier to put together.
Take the time to put the data into the right shape
before you try to produce a plot.</p>
</div>
<div id="mapping-aesthetics" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> Mapping aesthetics<a href="better-plots-with-ggplot2.html#mapping-aesthetics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The most important concept in <code>ggplot2</code> is <strong>mapping</strong>
each variable in the data to an <strong>aesthetic</strong> feature
of the plot. A wide variety of plots can be put together
using a small number of common aesthetics. The aesthetic
mapping for a plot is set up using the <code>aes()</code> function.</p>
<p>Think about a scatterplot - one variable is mapped
to the position along the x-axis, and another
is mapped to the position along the y-axis. So
a basic scatterplot in ggplot is:</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="better-plots-with-ggplot2.html#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cow, <span class="fu">aes</span>(<span class="at">x =</span> neuroticism, <span class="at">y =</span> depression)) <span class="sc">+</span></span>
<span id="cb246-2"><a href="better-plots-with-ggplot2.html#cb246-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="Rad_files/figure-html/basic_ggplot_scatterplot-1.png" width="384" /></p>
<p>You could also map another variable to the colour of the points:</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="better-plots-with-ggplot2.html#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cow, </span>
<span id="cb247-2"><a href="better-plots-with-ggplot2.html#cb247-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> neuroticism, <span class="at">y =</span> depression, <span class="at">colour =</span> sex)) <span class="sc">+</span></span>
<span id="cb247-3"><a href="better-plots-with-ggplot2.html#cb247-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="Rad_files/figure-html/ggplot_scatter_colours-1.png" width="384" /></p>
<p>Sometimes you want to change the look of <em>everything</em> in the plot,
without it being specific to individual data points. In that
case, you don’t put it in the <code>aes()</code> mapping, you <strong>set it as an
argument for the geom you want to change</strong>. Everything
that <strong>varies based on data</strong> should still go in <code>aes()</code>. For
example, when scatterplots have lots of points it helps
to make them transparent so you can see how many points
are overlapping:</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="better-plots-with-ggplot2.html#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cow, </span>
<span id="cb248-2"><a href="better-plots-with-ggplot2.html#cb248-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> neuroticism, <span class="at">y =</span> depression, <span class="at">colour =</span> sex)) <span class="sc">+</span></span>
<span id="cb248-3"><a href="better-plots-with-ggplot2.html#cb248-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>)</span></code></pre></div>
<p><img src="Rad_files/figure-html/ggplot_scatter_alpha-1.png" width="384" /></p>
</div>
<div id="geoms-representing-the-data-with-different-components" class="section level2 hasAnchor" number="8.3">
<h2><span class="header-section-number">8.3</span> geoms: representing the data with different components<a href="better-plots-with-ggplot2.html#geoms-representing-the-data-with-different-components" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><code>ggplot2</code> doesn’t have functions for specific kinds of plots
like a “boxplot” or “bar chart.” It does have all the components
you need to put these together though.</p>
<p>A boxplot will usually have:</p>
<ul>
<li>A categorical variable mapped to <code>x</code></li>
<li>A continuous variable mapped to <code>y</code></li>
<li>Possibly extra variables mapped to the “fill colour” of
the boxes.</li>
</ul>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="better-plots-with-ggplot2.html#cb249-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cow, <span class="fu">aes</span>(<span class="at">x =</span> sex, <span class="at">y =</span> depression, <span class="at">fill =</span> volunteer)) <span class="sc">+</span></span>
<span id="cb249-2"><a href="better-plots-with-ggplot2.html#cb249-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="Rad_files/figure-html/ggplot_boxplot_example-1.png" width="384" /></p>
<p>A bar chart will usually have:</p>
<ul>
<li>A discrete variable mapped to <code>x</code></li>
<li>Another variable mapped to <code>fill</code> that defines
the subgroups.</li>
<li>No variable mapped to <code>y</code>: <code>y</code> in a bar chart is
normally just the count (number of rows) in
each subgroup.</li>
<li>The bars for the subgroups either “stacked” on top
of each other or side by side (ggplot2 calls this
“dodging”)</li>
</ul>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="better-plots-with-ggplot2.html#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cow, <span class="fu">aes</span>(<span class="at">x =</span> sex, <span class="at">fill =</span> volunteer)) <span class="sc">+</span></span>
<span id="cb250-2"><a href="better-plots-with-ggplot2.html#cb250-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>)</span></code></pre></div>
<p><img src="Rad_files/figure-html/ggplot_bar_example-1.png" width="384" /></p>
<p>We’ve done some very standard plot types here
to help illustrate how each plot can be broken down
into its aesthetic mappings, but the real power
of ggplot is that you aren’t tied to the standard
kinds of plots - you can mix and match their
components to produce a unique plot that shows
exactly what you want.</p>
</div>
<div id="combining-geoms" class="section level2 hasAnchor" number="8.4">
<h2><span class="header-section-number">8.4</span> Combining geoms<a href="better-plots-with-ggplot2.html#combining-geoms" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Here we’ll produce a plot that shows:</p>
<ul>
<li>The individual data points (“jittered” a bit so they
don’t all overlap)</li>
<li>Contours that show how dense the points are</li>
<li>A “line of best fit” that shows the overall relationship
between two variables</li>
</ul>
<p>When you plot multiple geoms, the order you put them
together defines which element will be on top - the
first geom is on the bottom.</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="better-plots-with-ggplot2.html#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cow, <span class="fu">aes</span>(<span class="at">x =</span> neuroticism, <span class="at">y =</span> depression)) <span class="sc">+</span></span>
<span id="cb251-2"><a href="better-plots-with-ggplot2.html#cb251-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_density_2d</span>(<span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">stat</span>(level)),</span>
<span id="cb251-3"><a href="better-plots-with-ggplot2.html#cb251-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">geom =</span> <span class="st">&quot;polygon&quot;</span>,</span>
<span id="cb251-4"><a href="better-plots-with-ggplot2.html#cb251-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb251-5"><a href="better-plots-with-ggplot2.html#cb251-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_jitter</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb251-6"><a href="better-plots-with-ggplot2.html#cb251-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">colour =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb251-7"><a href="better-plots-with-ggplot2.html#cb251-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_viridis_c</span>() <span class="sc">+</span></span>
<span id="cb251-8"><a href="better-plots-with-ggplot2.html#cb251-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="Rad_files/figure-html/ggplot_complex_example-1.png" width="672" /></p>
<p>This plot is probably a little bit too “busy” to be really useful -
when you have so many options for what you can fit in a plot,
you have to make good choices about what’s most important to
include.</p>
</div>
<div id="scales-and-themes-changing-the-look-of-your-plot" class="section level2 hasAnchor" number="8.5">
<h2><span class="header-section-number">8.5</span> Scales and themes: changing the look of your plot<a href="better-plots-with-ggplot2.html#scales-and-themes-changing-the-look-of-your-plot" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Once you have a functioning <code>ggplot</code> plot put together,
you can start customising the look of it easily by using
different <strong>scales</strong> (which change how a variable maps
to a particular aesthetic feature of the plot) and
<strong>themes</strong> (which change more general elements
of the plot like the background colour).</p>
<div id="scales" class="section level3 hasAnchor" number="8.5.1">
<h3><span class="header-section-number">8.5.1</span> Scales<a href="better-plots-with-ggplot2.html#scales" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Scales serve a few different purposes:</p>
<ul>
<li>Changing the order of values: e.g. reversing the order on the x-axis</li>
<li>Transforming values, e.g. log-transforming your y-axis</li>
<li>Choosing how your values will be represented - particularly their
<strong>colours</strong>.</li>
</ul>
<p>The scales in ggplot generally have two parts to their names, like
<code>scale_x_log10()</code> and <code>scale_colour_gradient()</code>. The two parts indicate:</p>
<ul>
<li>Which aesthetic of the plot the scale is for.</li>
<li>What kind of scale will be applied for that aesthetic</li>
</ul>
<div id="scale-examples" class="section level4 unnumbered hasAnchor">
<h4>Scale examples<a href="better-plots-with-ggplot2.html#scale-examples" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>If you just need to reverse the order of a continuous x or y-axis, use
<code>scale_x_reverse()</code> or <code>scale_y_reverse()</code>. Returning to our
scatter plot from above:</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="better-plots-with-ggplot2.html#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cow, </span>
<span id="cb252-2"><a href="better-plots-with-ggplot2.html#cb252-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> neuroticism, <span class="at">y =</span> depression, <span class="at">colour =</span> sex)) <span class="sc">+</span></span>
<span id="cb252-3"><a href="better-plots-with-ggplot2.html#cb252-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb252-4"><a href="better-plots-with-ggplot2.html#cb252-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_reverse</span>()</span></code></pre></div>
<p><img src="Rad_files/figure-html/ggplot_scatter_reversed-1.png" width="384" /></p>
<p>Log-transforms can be useful for variables like income that are skewed
and have a few very large values. Use <code>scale_x_log10()</code> or <code>scale_y_log10()</code>,
and note how the axis increases in multiples rather than a constant rate:</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="better-plots-with-ggplot2.html#cb253-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cow, <span class="fu">aes</span>(<span class="at">x =</span> sex, <span class="at">fill =</span> volunteer)) <span class="sc">+</span></span>
<span id="cb253-2"><a href="better-plots-with-ggplot2.html#cb253-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="sc">+</span></span>
<span id="cb253-3"><a href="better-plots-with-ggplot2.html#cb253-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_log10</span>()</span></code></pre></div>
<p><img src="Rad_files/figure-html/ggplot_log_example-1.png" width="384" /></p>
<p>Changing the colour scale you’re using in your plot is useful both
because you can pick a more meaningful scale, and because it can
really improve the overall look and clarity of your plot. Picking
colours that look good is a valid reason!</p>
<p>To demonstrate some of these colour scales, we’ll first create
a categorical variable that splits our depression scores up into
5 categories. We’ll also create a table of the mean neuroticism
and extraversion scores in each category:</p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="better-plots-with-ggplot2.html#cb254-1" aria-hidden="true" tabindex="-1"></a>cow<span class="sc">$</span>depression_cat <span class="ot">=</span> <span class="fu">cut</span>(</span>
<span id="cb254-2"><a href="better-plots-with-ggplot2.html#cb254-2" aria-hidden="true" tabindex="-1"></a>    cow<span class="sc">$</span>depression, <span class="at">breaks =</span> <span class="dv">5</span>,</span>
<span id="cb254-3"><a href="better-plots-with-ggplot2.html#cb254-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Very low&quot;</span>, <span class="st">&quot;Low&quot;</span>, <span class="st">&quot;Average&quot;</span>,</span>
<span id="cb254-4"><a href="better-plots-with-ggplot2.html#cb254-4" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;High&quot;</span>, <span class="st">&quot;Very high&quot;</span>))</span>
<span id="cb254-5"><a href="better-plots-with-ggplot2.html#cb254-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-6"><a href="better-plots-with-ggplot2.html#cb254-6" aria-hidden="true" tabindex="-1"></a>dep_tab <span class="ot">=</span> cow <span class="sc">%&gt;%</span></span>
<span id="cb254-7"><a href="better-plots-with-ggplot2.html#cb254-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(depression_cat) <span class="sc">%&gt;%</span></span>
<span id="cb254-8"><a href="better-plots-with-ggplot2.html#cb254-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">introversion =</span> <span class="fu">mean</span>(neuroticism),</span>
<span id="cb254-9"><a href="better-plots-with-ggplot2.html#cb254-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">extraversion =</span> <span class="fu">mean</span>(extraversion)) <span class="sc">%&gt;%</span></span>
<span id="cb254-10"><a href="better-plots-with-ggplot2.html#cb254-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="sc">-</span>depression_cat, </span>
<span id="cb254-11"><a href="better-plots-with-ggplot2.html#cb254-11" aria-hidden="true" tabindex="-1"></a>                 <span class="at">names_to =</span> <span class="st">&quot;Outcome&quot;</span>,</span>
<span id="cb254-12"><a href="better-plots-with-ggplot2.html#cb254-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">values_to =</span> <span class="st">&quot;Mean&quot;</span>)</span></code></pre></div>
<p>Plotting with the default colours doesn’t give great results:</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="better-plots-with-ggplot2.html#cb255-1" aria-hidden="true" tabindex="-1"></a>dep_cat_plot <span class="ot">=</span> <span class="fu">ggplot</span>(</span>
<span id="cb255-2"><a href="better-plots-with-ggplot2.html#cb255-2" aria-hidden="true" tabindex="-1"></a>    dep_tab, </span>
<span id="cb255-3"><a href="better-plots-with-ggplot2.html#cb255-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> Outcome, <span class="at">y =</span> Mean, <span class="at">fill =</span> depression_cat)) <span class="sc">+</span></span>
<span id="cb255-4"><a href="better-plots-with-ggplot2.html#cb255-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">&#39;dodge&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span></span>
<span id="cb255-5"><a href="better-plots-with-ggplot2.html#cb255-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># \n creates a newline, i.e. splits the label into multiple lines</span></span>
<span id="cb255-6"><a href="better-plots-with-ggplot2.html#cb255-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">&quot;Depression</span><span class="sc">\n</span><span class="st">Category&quot;</span>) <span class="sc">+</span></span>
<span id="cb255-7"><a href="better-plots-with-ggplot2.html#cb255-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()</span>
<span id="cb255-8"><a href="better-plots-with-ggplot2.html#cb255-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-9"><a href="better-plots-with-ggplot2.html#cb255-9" aria-hidden="true" tabindex="-1"></a>dep_cat_plot</span></code></pre></div>
<p><img src="Rad_files/figure-html/dep_cat_default-1.png" width="384" /></p>
<p>Since the categories are increasing, we could use a colour scale
that maps colours in an ordered way. The <code>viridis</code> colour scales
look great and have a few useful properties like converting to
greyscale well and being colour-blind friendly. Using an ordered
colour scale helps to convey some of the meaning of the different
depression categories:</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="better-plots-with-ggplot2.html#cb256-1" aria-hidden="true" tabindex="-1"></a>dep_cat_plot <span class="sc">+</span> </span>
<span id="cb256-2"><a href="better-plots-with-ggplot2.html#cb256-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Tweaked slightly to avoid using a very bright yellow</span></span>
<span id="cb256-3"><a href="better-plots-with-ggplot2.html#cb256-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">#   at the top end of the scale</span></span>
<span id="cb256-4"><a href="better-plots-with-ggplot2.html#cb256-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">&quot;C&quot;</span>, <span class="at">end =</span> <span class="fl">0.9</span>)</span></code></pre></div>
<p><img src="Rad_files/figure-html/dep_cat_viridis-1.png" width="384" /></p>
<div class="note">
<p>
The aesthetic that determines the colour of the bars is <code>fill</code>, not <code>colour</code>, so we use <code>scale_fill</code> to change it. Check whether your plot is using the <code>fill</code> or the <code>colour</code> aesthetic to make sure you change the right one.
</p>
</div>
<p>We could also use a <strong>diverging</strong> colour scale that emphasises
how far each category is from the average. ggplot includes
some great scales from <a href="http://colorbrewer2.org/">ColorBrewer</a> that
serve this purpose:</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="better-plots-with-ggplot2.html#cb257-1" aria-hidden="true" tabindex="-1"></a>dep_cat_plot <span class="sc">+</span> </span>
<span id="cb257-2"><a href="better-plots-with-ggplot2.html#cb257-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_brewer</span>(<span class="at">type =</span> <span class="st">&quot;div&quot;</span>)</span></code></pre></div>
<p><img src="Rad_files/figure-html/dep_cat_diverging-1.png" width="384" /></p>
<p>Feel free to experiment with different scales when producing
your own plots!</p>
</div>
</div>
<div id="themes" class="section level3 hasAnchor" number="8.5.2">
<h3><span class="header-section-number">8.5.2</span> Themes<a href="better-plots-with-ggplot2.html#themes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Scales affect how your actual data is displayed, but to control the
overall look of the plot (background colour, font etc.), we use
<strong>themes</strong>. To use a different theme, just add it to your plot:</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="better-plots-with-ggplot2.html#cb258-1" aria-hidden="true" tabindex="-1"></a>dep_cat_plot <span class="sc">+</span></span>
<span id="cb258-2"><a href="better-plots-with-ggplot2.html#cb258-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_viridis_d</span>() <span class="sc">+</span></span>
<span id="cb258-3"><a href="better-plots-with-ggplot2.html#cb258-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="Rad_files/figure-html/ggplot_theming_example-1.png" width="384" /></p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="better-plots-with-ggplot2.html#cb259-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sjPlot should have been installed during an earlier</span></span>
<span id="cb259-2"><a href="better-plots-with-ggplot2.html#cb259-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   session, otherwise install it now</span></span>
<span id="cb259-3"><a href="better-plots-with-ggplot2.html#cb259-3" aria-hidden="true" tabindex="-1"></a>dep_cat_plot <span class="sc">+</span></span>
<span id="cb259-4"><a href="better-plots-with-ggplot2.html#cb259-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_viridis_d</span>() <span class="sc">+</span></span>
<span id="cb259-5"><a href="better-plots-with-ggplot2.html#cb259-5" aria-hidden="true" tabindex="-1"></a>    sjPlot<span class="sc">::</span><span class="fu">theme_538</span>()</span></code></pre></div>
<p><img src="Rad_files/figure-html/ggplot_theming_example-2.png" width="384" /></p>
<div id="tweaking-themes" class="section level4 hasAnchor" number="8.5.2.1">
<h4><span class="header-section-number">8.5.2.1</span> Tweaking themes<a href="better-plots-with-ggplot2.html#tweaking-themes" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Every aspect of a plot’s theme can be tweaked using <code>theme()</code>.
You can see the full list of properties that can be changed by looking
at <code>?theme</code>.
The full details are beyond the scope of this brief introduction,
but one useful tweak is turning off particular elements by setting
them to <code>element_blank()</code>. We can disable the title on the x-axis:</p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="better-plots-with-ggplot2.html#cb260-1" aria-hidden="true" tabindex="-1"></a>dep_cat_plot <span class="sc">+</span></span>
<span id="cb260-2"><a href="better-plots-with-ggplot2.html#cb260-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_viridis_d</span>() <span class="sc">+</span></span>
<span id="cb260-3"><a href="better-plots-with-ggplot2.html#cb260-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="Rad_files/figure-html/theme_tweak_example-1.png" width="384" /></p>
</div>
</div>
<div id="finding-extra-scales-and-themes" class="section level3 hasAnchor" number="8.5.3">
<h3><span class="header-section-number">8.5.3</span> Finding extra scales and themes<a href="better-plots-with-ggplot2.html#finding-extra-scales-and-themes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Packages like <code>ggthemes</code> provide extra scales and themes: install
them, load them and you can use the scales and themes just like
the built in ones by adding them to your plot. I particularly like
<code>ggthemes::theme_fivethirtyeight()</code>
and <code>ggthemes::scale_colour_tableau()</code>, but there a wide variety
of useful and great-looking options out there.</p>
</div>
</div>
<div id="other-packages-use-ggplot2-too" class="section level2 hasAnchor" number="8.6">
<h2><span class="header-section-number">8.6</span> Other packages use <code>ggplot2</code> too<a href="better-plots-with-ggplot2.html#other-packages-use-ggplot2-too" class="anchor-section" aria-label="Anchor link to header"></a></h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="tidyverse.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="real-world-data-example.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/Hi-Vis/Marius_edits2/08-ggplot_plots.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
